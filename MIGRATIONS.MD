1. there is console part and and copilot part. copilot is what alchemi-web and alchemi-ai does, this is where uses from different tenants (basically different accounts each belonging to a company or enterprise). Console is where developers and development teams from the company or enterprise can get api access to different llm from multiple vendors, have access to guardrails, mcp, see how much it costs, see the logs.. 

Now both of these different products under the same suite need to be controlled, maintained and managed by an IT admin of the company who acts as the tenant or account admin), this is dont through cockpit. 
For the copilot part:
1. The account admin can create organizations, teamsn and users. Allocate credits for them (this is in dollars but just credits- credits are calucluated by multiplying the cost and credit factor, the credit factor is set by a super admin for each tenant or account).
2. The account admin should also be be able distribute the credits between different orgs, teams and users, simly say like divide these x credits between the y orgs/teams/users equally. and then they should also be able to override it
3. The acount admin should also be able to create these agenets and connect them to different tools and give access to these agents to specific orgs, teams and users. For example, they should be able to say that this agent can only be used by this org or this team or this user. They should also be able to set the guardrails for these agents, for example, they should be able to say that this agent should alway go through the PII guardrail or this agent should always go through the content moderation guardrail... These are preset guardrails.
Check the code in alchemi-web and alchemi-ai, /workspaces/alchemi-ai/gen_ui_backend/api/agent_wizard_conversation_v2.py and /workspaces/alchemi-web/src/components/unapp/config-components/agent-wizard-conversational.tsx for reference on how agents are created and connected to tools. Replicate the same in cockpit but with more features and more control to the account admin.
4. The account admin should also be able to set guardrails for the different orgs, teams and users. For example, they should be able to say that this org or this team or this user should always go through the PII guardrail or this org or this team or this user should always go through the Jail break guardrail... These are preset guardrails. alchemi-web cockpit path had these setttings check them.
5. Similary to creating agents and giving access to them, the account admin should also be able to add connections (openapi, mcp and composio) to different orgs, teams and users. Composio supports both oauth and apikey. It should have 2 levels the account admin can give access to where they can let the users create their own connections or they can create connections for them and just give them access to use those connections without the ability edit or see them. For openapi and mcp, the users should not be able to see the credentials created by the account admin, they should only be able to use them. But users can add their own connections if the account admin allows them to. (the code is already there to add their own mcp and openapi connections)
Check the code in alchemi-web and alchemi-ai /workspaces/alchemi-web/src/components/unapp/workspace-home/sections/IntegrationsSection.tsx to see how connections are added and managed. Replicate the same in cockpit but with more features and more control to the account admin.
- Agent management: We can have a centralized agent management system in the cockpit, where admins can create, edit and delete agents, and assign them to specific users or teams. alchemi-web path in /cockpit/marketplace and alchemi-web path in /cockpit/agentdef in alchemi-web.
- Tool management: Similar to agent management, we can have a centralized tool management system in the cockpit, where admins can manage the tools that are available to the users, and assign them to specific users or teams. alchemi-web path in /cockpit/connections  in alchemi-web.
- Basically we need to move all of the management in /cockpit in alchemi-web to the console-cockpit, and make the /cockpit in alchemi-web and alchemi-ai as clients that call the centralized cockpit APIs to manage these features. 
- Guardrails and audit logs

6. The account admin should be able to see the logs of all the activities happening in both copilot. This also already exists in alchemi-web cockpit, /workspaces/alchemi-web/src/app/(private)/(cockpit)/cockpit/audit-logs/page.tsx
7. The account admin should also be able to manage the llms, as is set who can access which llms. The llms are preconfigured by super admin for each tenant or account, but the account admin can decide which orgs, teams and users can access which llms. For example, they should be able to say that this org can access gpt5 and claude 4.5 but not gemini pro, or this team can only access claude haiku 4.5 and not gpt5...
8. The account admin should also be able to see the credits incurred by different orgs, teams and users. They should be able to see the breakdown of the cost by different agents, llms,connections and guardrails used. This will help them understand where the most cost is being incurred and optimize accordingly.
9. An admin should be able to selevively enable or disable access to certain features for different orgs, teams and users. The list of features includes: ability to create connectinons (openapi, mcp, composio) and ability to create agents themselves, image generation, access to different llms. 
10. Let there be a default org called global for all users so something can easily set for everyone.
11. The agents and connections created by the account admin should be available as part of the marketplace for the users where they can easily find and use them. 
12.  I am not too keen on workspace management in /cockpit in alchemi-web, but more on the agent, connections, guardrails, tool, user management and budget management. Workspace management can be left out.

For the console part:
We have used litellm as base and created a console on top of it. The console is where developers and development teams from the company or enterprise can get api access to different llm from multiple vendors, have access to guardrails, mcp, see how much it costs, see the logs.. The account admin will be able to created these llms, guardrails and connections in the console and then give access to them to different orgs, teams and users from the cockpit. 


console-cockpit is a combination of console and cockpit where the account admin can manage both the console and copilot part. They can create and manage llms, guardrails, connections, agents, organizations, teams and users from the console-cockpit and then give access to them accordingly. The developers and development teams will primarily interact with the console part to use the llms, guardrails, connections and agents that are made available to them by the account admin through the console-cockpit. This is already there.

The cockpit part for copilot where the account admin can manage the copilot part as mentioned above is also mostly there but it needs to be revamped and made more robust with more features and better control for the account admin. The idea is to have a single unified cockpit where the account admin can manage everything related to both console and copilot part of the suite. They should be able to easily navigate between managing the console part and the copilot part without feeling like they are in two different products. The user experience should be seamless and intuitive. The cockpit for copilot was largely implemented inside alchemi-web /cockpit but we want to move it to console-cockpit and revamp it with more features and better control for the account admin.

Finally there is a super admin role which is responsible for managing the tenants or accounts. The super admin can create and manage different tenants or accounts, set the credit factor for each tenant or account, allocate credits for the console to different accounts, that gets renewed every month, may also override the credits for the account. be able to set admin for accounts, set sso for these accounts and have an overview of all the activities happening across different tenants or accounts. They should be anle to manage the llm models for console part that are available for different accounts. This what is there distributed between alchemi-admin and console-cockpit but we want to move all of this to console-cockpit for better management and control. Also rationalize the features and controls available to the super admin and account admin for better user experience and ease of use. The super admin should also be able to control which account has what features. 


For Copilot Credits/Budget Methodology

Use a parent-child allocation model:

1. Super admin allocates account-level credits and also assigns overflow limit. The overflow limit allows accounts to exceed their allocated credits up to a certain limit, which can be useful for handling unexpected usage spikes. The super admin can set this limit based on the account's historical usage patterns and business needs. This provides flexibility while still maintaining control over overall credit usage. The overflow credits are charged later to the accounts.
2. At account start, credits remain **Unallocated**.
3. Account admin allocates from Unallocated to:
   - organizations/groups
   - teams
   - users
   - Pool credits for overflow usage or to be allocated later.
4. Support equal distribution + per-user override.
5. Periodic renewal/cycle logic at budget plan level.
6. Effective allocation view must show inheritance and override resolution.
7. Credit accounting formula is tied to Copilot model cost policy (`cost * CREDITS_FACTOR`).



This is the exercise we are currently doing. but right now its a mess of things that dont make any sense and is not organized at all. We want to take a step back, understand the concept and then come up with a well thought out plan on how to implement this in a structured and organized way. We want to have a clear separation of concerns between the different roles and products, but at the same time we want to have a unified cockpit where the account admin can manage everything related to both console and copilot part of the suite. The user experience should be seamless and intuitive for both the account admin and the developers using the console part. All this with multi-tenancy in mind, so that different accounts can have their own isolated environments, with their own users, agents, tools, and budgets.


Do a thorough analysis of the current features in alchemi-web, alchemi-ai, alchemi-admin and console-cockpit and see how we can integrate them into the centralized cockpit. We should also consider the user experience and design of the centralized cockpit, to ensure that it is intuitive and easy to use for both admins and users. I think we need not worry about legacy code or migration as this will be a fresh production.

Come up with a detailed plan and roadmap for the development of the centralized cockpit, changes to alchemi-web and alchemi-ai, and the integration between them. This will require diligent attention to detail and careful planning to ensure a smooth transition and successful implementation of the centralized cockpit. 

Its not about just merging codebases, but basically want the alchemi-web and alchemi-ai to be clients of the centralized cockpit, where they can call the APIs of the centralized cockpit to manage users, agents, tools, budgets, and other features. This way we can have a more modular and scalable architecture, where the centralized cockpit can serve multiple products and clients, and we can also have a more consistent and unified experience for the users across all products.


Note: Keep the orgs, teams and users separate for console and copilot part for better management. Keep the copilot settings also separate from the console settings in the cockpit but make it easily accessible and manageable for the account admin. The console-cockpit should have a clear and intuitive navigation to switch between managing the console part and the copilot part without feeling like they are in two different products. Whenever we are recreating a feature use same code from alchemi-web and alchemi-ai but revamp it with better design, more features and better control for the account admin. Its ok to use shadcn along with antd, make sure the design is consistent across the cockpit.
One important think to remember, for alchemi-web and alchemi-ai features we port and also to control them we sould have a separate section called copilot in console-cockpit that manages these, it can reuse backend but needs to have separate, orgs and teams that need to be managed separately from the main console-cockpit orgs and teams, manage budgets, managent marketplace of agents, and tools and even audit logs as they are specific to alchemi-web and alchemi-ai. Also the llms (models) that are used in alchemi-web and alchemi-ai are specific to copilot, so we need to have a way to manage them separately in the centralized cockpit. Basically for the AI gateway in  console-cockpit version, enterprises (accounts) bring their own llms, so we need to have a way to manage those llms separately from the ones used in alchemi-web and alchemi-ai, which are more focused on providing agentic workspaces for enterprise users.


Note: console-cockpit is built on top of litellm, so we need to maintain the modularity as mentioned in the instructions.md file. 